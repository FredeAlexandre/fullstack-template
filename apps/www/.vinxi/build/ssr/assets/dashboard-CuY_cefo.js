import{jsx as s,jsxs as d,Fragment as T}from"react/jsx-runtime";import*as i from"react";import{useState as N}from"react";import{queryOptions as me,useSuspenseQuery as ge,useQueryClient as he,useMutation as ve}from"@tanstack/react-query";import{u as E,S as De,c as g,B as A}from"./button-U5Omqg_X.js";import{c as ye,d as h,P as _,e as Ne,b as Ce}from"./index-DJ3tN8qV.js";import{R as Re,h as xe,a as Ee,F as _e,D as Pe,P as be,u as C}from"./Combination-BnSwnZvs.js";import{P as v}from"./index-DXPxg-Qg.js";import{X as we,LoaderCircleIcon as Ie}from"lucide-react";import{I as R,L as S}from"./input-i05uZG0N.js";import{c as M,a as $,f as j,d as k,p as x,C as Oe}from"./ssr-ClLmdAie.js";import{eq as Te}from"drizzle-orm";import{useRouter as Ae,isRedirect as F}from"@tanstack/react-router";import"react-dom";import"h3";import"node:async_hooks";import"node:stream";import"react-dom/server";import"@tanstack/react-router-with-query";import"@tanstack/router-devtools";import"sonner";import"usehooks-ts";import"fs";import"path";import"os";import"crypto";import"drizzle-orm/node-postgres";import"better-auth";import"better-auth/adapters/drizzle";import"better-auth/plugins";import"drizzle-orm/pg-core";import"drizzle-orm/mysql-core";import"drizzle-orm/sqlite-core";import"zod";function Se(e){const t=Ae();return async(...o)=>{try{const r=await e(...o);if(F(r))throw r;return r}catch(r){if(F(r)){const n=t.resolveRedirect({...r,_fromLocation:t.state.location});return t.navigate(n)}throw r}}}var P="Dialog",[L,Tt]=ye(P),[Fe,u]=L(P),W=e=>{const{__scopeDialog:t,children:o,open:r,defaultOpen:n,onOpenChange:a,modal:l=!0}=e,c=i.useRef(null),p=i.useRef(null),[f=!1,y]=Ce({prop:r,defaultProp:n,onChange:a});return s(Fe,{scope:t,triggerRef:c,contentRef:p,contentId:C(),titleId:C(),descriptionId:C(),open:f,onOpenChange:y,onOpenToggle:i.useCallback(()=>y(fe=>!fe),[y]),modal:l,children:o})};W.displayName=P;var G="DialogTrigger",q=i.forwardRef((e,t)=>{const{__scopeDialog:o,...r}=e,n=u(G,o),a=E(t,n.triggerRef);return s(v.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":I(n.open),...r,ref:a,onClick:h(e.onClick,n.onOpenToggle)})});q.displayName=G;var b="DialogPortal",[Me,B]=L(b,{forceMount:void 0}),U=e=>{const{__scopeDialog:t,forceMount:o,children:r,container:n}=e,a=u(b,t);return s(Me,{scope:t,forceMount:o,children:i.Children.map(r,l=>s(_,{present:o||a.open,children:s(be,{asChild:!0,container:n,children:l})}))})};U.displayName=b;var D="DialogOverlay",z=i.forwardRef((e,t)=>{const o=B(D,e.__scopeDialog),{forceMount:r=o.forceMount,...n}=e,a=u(D,e.__scopeDialog);return a.modal?s(_,{present:r||a.open,children:s($e,{...n,ref:t})}):null});z.displayName=D;var $e=i.forwardRef((e,t)=>{const{__scopeDialog:o,...r}=e,n=u(D,o);return s(Re,{as:De,allowPinchZoom:!0,shards:[n.contentRef],children:s(v.div,{"data-state":I(n.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),m="DialogContent",Q=i.forwardRef((e,t)=>{const o=B(m,e.__scopeDialog),{forceMount:r=o.forceMount,...n}=e,a=u(m,e.__scopeDialog);return s(_,{present:r||a.open,children:a.modal?s(je,{...n,ref:t}):s(ke,{...n,ref:t})})});Q.displayName=m;var je=i.forwardRef((e,t)=>{const o=u(m,e.__scopeDialog),r=i.useRef(null),n=E(t,o.contentRef,r);return i.useEffect(()=>{const a=r.current;if(a)return xe(a)},[]),s(H,{...e,ref:n,trapFocus:o.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:h(e.onCloseAutoFocus,a=>{a.preventDefault(),o.triggerRef.current?.focus()}),onPointerDownOutside:h(e.onPointerDownOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0;(l.button===2||c)&&a.preventDefault()}),onFocusOutside:h(e.onFocusOutside,a=>a.preventDefault())})}),ke=i.forwardRef((e,t)=>{const o=u(m,e.__scopeDialog),r=i.useRef(!1),n=i.useRef(!1);return s(H,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{e.onCloseAutoFocus?.(a),a.defaultPrevented||(r.current||o.triggerRef.current?.focus(),a.preventDefault()),r.current=!1,n.current=!1},onInteractOutside:a=>{e.onInteractOutside?.(a),a.defaultPrevented||(r.current=!0,a.detail.originalEvent.type==="pointerdown"&&(n.current=!0));const l=a.target;o.triggerRef.current?.contains(l)&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&n.current&&a.preventDefault()}})}),H=i.forwardRef((e,t)=>{const{__scopeDialog:o,trapFocus:r,onOpenAutoFocus:n,onCloseAutoFocus:a,...l}=e,c=u(m,o),p=i.useRef(null),f=E(t,p);return Ee(),d(T,{children:[s(_e,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:n,onUnmountAutoFocus:a,children:s(Pe,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":I(c.open),...l,ref:f,onDismiss:()=>c.onOpenChange(!1)})}),d(T,{children:[s(Le,{titleId:c.titleId}),s(Ge,{contentRef:p,descriptionId:c.descriptionId})]})]})}),w="DialogTitle",V=i.forwardRef((e,t)=>{const{__scopeDialog:o,...r}=e,n=u(w,o);return s(v.h2,{id:n.titleId,...r,ref:t})});V.displayName=w;var K="DialogDescription",X=i.forwardRef((e,t)=>{const{__scopeDialog:o,...r}=e,n=u(K,o);return s(v.p,{id:n.descriptionId,...r,ref:t})});X.displayName=K;var Y="DialogClose",Z=i.forwardRef((e,t)=>{const{__scopeDialog:o,...r}=e,n=u(Y,o);return s(v.button,{type:"button",...r,ref:t,onClick:h(e.onClick,()=>n.onOpenChange(!1))})});Z.displayName=Y;function I(e){return e?"open":"closed"}var J="DialogTitleWarning",[At,ee]=Ne(J,{contentName:m,titleName:w,docsSlug:"dialog"}),Le=({titleId:e})=>{const t=ee(J),o=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return i.useEffect(()=>{e&&(document.getElementById(e)||console.error(o))},[o,e]),null},We="DialogDescriptionWarning",Ge=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${ee(We).contentName}}.`;return i.useEffect(()=>{const n=e.current?.getAttribute("aria-describedby");t&&n&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},qe=W,Be=q,Ue=U,te=z,oe=Q,re=V,ae=X,ze=Z;const Qe=qe,He=Be,Ve=Ue,ne=i.forwardRef(({className:e,...t},o)=>i.createElement(te,{ref:o,className:g("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));ne.displayName=te.displayName;const se=i.forwardRef(({className:e,children:t,...o},r)=>i.createElement(Ve,null,i.createElement(ne,null),i.createElement(oe,{ref:r,className:g("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...o},t,i.createElement(ze,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground"},i.createElement(we,{className:"h-4 w-4"}),i.createElement("span",{className:"sr-only"},"Close")))));se.displayName=oe.displayName;const ie=({className:e,...t})=>i.createElement("div",{className:g("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});ie.displayName="DialogHeader";const ce=({className:e,...t})=>i.createElement("div",{className:g("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});ce.displayName="DialogFooter";const le=i.forwardRef(({className:e,...t},o)=>i.createElement(re,{ref:o,className:g("text-lg font-semibold leading-none tracking-tight",e),...t}));le.displayName=re.displayName;const de=i.forwardRef(({className:e,...t},o)=>i.createElement(ae,{ref:o,className:g("text-sm text-muted-foreground",e),...t}));de.displayName=ae.displayName;const ue=M({method:"GET"}).handler($(Ke,"c_19i7ppj","$$function0"),async()=>{const e=await j();if(!e)throw new Error("User not connected");return k.select().from(x).where(Te(x.userId,e.user.id))}),O=()=>me({queryKey:["projects"],queryFn:()=>ue()}),pe=M({method:"POST"}).validator(e=>Oe.omit({userId:!0}).parse(e)).handler($(Xe,"c_19i7ppj","$$function1"),async({data:e})=>{const t=await j();if(!t)throw new Error("User not connected");await k.insert(x).values({userId:t.user.id,...e})});function Ke(e){return ue.__executeServer(e)}function Xe(e){return pe.__executeServer(e)}function Ye(){const[e,t]=N(""),[o,r]=N(void 0),[n,a]=N(!1),l=he(),{mutate:c,isPending:p}=ve({mutationFn:Se(pe),onSuccess:()=>{a(!1),l.invalidateQueries(O())}});return d(Qe,{open:n,onOpenChange:a,children:[s(He,{asChild:!0,children:s(A,{children:"Add Project"})}),d(se,{className:"sm:max-w-[425px]",children:[d(ie,{children:[s(le,{children:"Add project"}),s(de,{children:"Create a new project to your project list."})]}),d("div",{className:"space-y-4",children:[d("div",{className:"space-y-1",children:[s(S,{htmlFor:"name",children:"Name"}),s(R,{value:e,onChange:f=>{t(f.target.value)},id:"name",placeholder:"Uniswap V5",className:"col-span-3"})]}),d("div",{className:"space-y-1",children:[s(S,{htmlFor:"description",children:"Description"}),s(R,{value:o,onChange:f=>{r(f.target.value)},id:"description",placeholder:"The next generation of exchange",className:"col-span-3"})]})]}),s(ce,{children:s(A,{type:"submit",disabled:p,onClick:()=>c({data:{name:e,description:o}}),children:p?s(Ie,{className:"animate-spin size-4"}):"Create project"})})]})]})}const St=function(){const{data:t}=ge(O());return d("div",{className:"container mx-auto py-6 space-y-6",children:[d("div",{className:"flex gap-2",children:[s(R,{placeholder:"Search projects",className:"bg-background"}),s(Ye,{})]}),s("div",{className:"grid grid-cols-4 gap-4",children:t?t.map(o=>d("div",{className:"border rounded p-4 w-full bg-background",children:[s("div",{children:o.name}),s("div",{className:"text-sm text-muted-foreground",children:o.description})]},o.id)):null})]})},Ft=async({context:e})=>{await e.queryClient.ensureQueryData(O())};export{St as component,Ft as loader};
