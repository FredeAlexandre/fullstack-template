import{r as i,j as C,a as H,b as Le}from"./client-B6G1yI40.js";import{B as zn}from"./button-ZFDmQ8y7.js";import{c as nn}from"./createLucideIcon-DrdjHrXf.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=nn("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=nn("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Vn={contracts:[],functions:[],addContract:()=>{},addFunction:()=>{},addFunctionToContract:()=>{},delFunctionContract:()=>{},changeFunctionName:()=>{},changeFunctionView:()=>{},getFunctionName:()=>"function",getFunctionView:()=>!0,updatePosition:()=>{}},de=i.createContext(Vn),Un=({children:e})=>{const[t,n]=i.useState([]),[r,o]=i.useState([]),s=w=>{n(h=>[...h,w])},a=w=>o(h=>[...h,w]),c=(w,h)=>{n(f=>f.map(d=>{if(d.props.id===w){const b={id:h.props.id,name:h.props.name,content:h.props.content,position:h.props.position,variables:h.props.variables,viewInside:h.props.viewInside},v=[...d.props.functions,b];return{content:"contract",props:{id:w,name:d.props.name,content:d.props.content,position:d.props.position,functions:v,variables:v}}}return d})),o(f=>f.filter(d=>d.props.id!==h.props.id))},l=(w,h)=>{n(f=>f.map(d=>{if(d.props.id===w){const b=d.props.functions.find(S=>S.id===h);if(b){const S={content:"function",props:{id:b.id,name:b.name,position:b.position,content:b.content,variables:b.variables,viewInside:b.viewInside}};a(S)}const v=d.props.functions.filter(S=>S.id!==h);return{content:"contract",props:{id:w,name:d.props.name,content:d.props.content,position:d.props.position,functions:v,variables:d.props.variables}}}return d}))},u=(w,h)=>{n(f=>f.map(d=>{const b=d.props.functions.map(v=>v.id===w?{...v,name:h}:v);return{...d,props:{...d.props,functions:b}}})),o(f=>f.map(d=>d.props.id===w?{...d,props:{...d.props,name:h}}:d))},g=(w,h)=>{n(f=>f.map(d=>{const b=d.props.functions.map(v=>v.id===w?{...v,viewInside:h}:v);return{...d,props:{...d.props,functions:b}}})),o(f=>f.map(d=>d.props.id===w?{...d,props:{...d.props,viewInside:h}}:d))},p=w=>{for(const f of t){const d=f.props.functions.find(b=>b.id===w);if(d)return d.name}const h=r.find(f=>f.props.id===w);return h?h.props.name:""},x=w=>{for(const f of t){const d=f.props.functions.find(b=>b.id===w);if(d)return d.viewInside}const h=r.find(f=>f.props.id===w);return h?h.props.viewInside:!0},m=(w,h,f)=>{n(d=>d.map(b=>{if(b.props.id===w)return{...b,props:{...b.props,position:{x:h,y:f}}};const v=b.props.functions.map(D=>D.id===w?{...D,position:{x:h,y:f}}:D);return{...b,props:{...b.props,functions:v}}})),o(d=>d.map(b=>b.props.id===w?{...b,props:{...b.props,position:{x:h,y:f}}}:b))};return C.jsx(de.Provider,{value:{contracts:t,functions:r,addContract:s,addFunction:a,addFunctionToContract:c,delFunctionContract:l,changeFunctionName:u,getFunctionName:p,getFunctionView:x,updatePosition:m,changeFunctionView:g},children:e})};function Xn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.useMemo(()=>r=>{t.forEach(o=>o(r))},t)}const it=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ie(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Rt(e){return"nodeType"in e}function q(e){var t,n;return e?Ie(e)?e:Rt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function St(e){const{Document:t}=q(e);return e instanceof t}function Xe(e){return Ie(e)?!1:e instanceof q(e).HTMLElement}function sn(e){return e instanceof q(e).SVGElement}function Ne(e){return e?Ie(e)?e.document:Rt(e)?St(e)?e:Xe(e)||sn(e)?e.ownerDocument:document:document:document}const ae=it?i.useLayoutEffect:i.useEffect;function Et(e){const t=i.useRef(e);return ae(()=>{t.current=e}),i.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.current==null?void 0:t.current(...r)},[])}function Kn(){const e=i.useRef(null),t=i.useCallback((r,o)=>{e.current=setInterval(r,o)},[]),n=i.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function ze(e,t){t===void 0&&(t=[e]);const n=i.useRef(e);return ae(()=>{n.current!==e&&(n.current=e)},t),n}function Ke(e,t){const n=i.useRef();return i.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function tt(e){const t=Et(e),n=i.useRef(null),r=i.useCallback(o=>{o!==n.current&&t?.(o,n.current),n.current=o},[]);return[n,r]}function xt(e){const t=i.useRef();return i.useEffect(()=>{t.current=e},[e]),t.current}let ht={};function Ye(e,t){return i.useMemo(()=>{if(t)return t;const n=ht[e]==null?0:ht[e]+1;return ht[e]=n,e+"-"+n},[e,t])}function an(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((s,a)=>{const c=Object.entries(a);for(const[l,u]of c){const g=s[l];g!=null&&(s[l]=g+e*u)}return s},{...t})}}const Se=an(1),Ve=an(-1);function Yn(e){return"clientX"in e&&"clientY"in e}function It(e){if(!e)return!1;const{KeyboardEvent:t}=q(e.target);return t&&e instanceof t}function Wn(e){if(!e)return!1;const{TouchEvent:t}=q(e.target);return t&&e instanceof t}function wt(e){if(Wn(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Yn(e)?{x:e.clientX,y:e.clientY}:null}const nt=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[nt.Translate.toString(e),nt.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Xt="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Hn(e){return e.matches(Xt)?e:e.querySelector(Xt)}const qn={display:"none"};function Gn(e){let{id:t,value:n}=e;return H.createElement("div",{id:t,style:qn},n)}function Jn(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return H.createElement("div",{id:t,style:o,role:"status","aria-live":r,"aria-atomic":!0},n)}function _n(){const[e,t]=i.useState("");return{announce:i.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const cn=i.createContext(null);function Qn(e){const t=i.useContext(cn);i.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Zn(){const[e]=i.useState(()=>new Set),t=i.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[i.useCallback(r=>{let{type:o,event:s}=r;e.forEach(a=>{var c;return(c=a[o])==null?void 0:c.call(a,s)})},[e]),t]}const er={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},tr={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function nr(e){let{announcements:t=tr,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=er}=e;const{announce:s,announcement:a}=_n(),c=Ye("DndLiveRegion"),[l,u]=i.useState(!1);if(i.useEffect(()=>{u(!0)},[]),Qn(i.useMemo(()=>({onDragStart(p){let{active:x}=p;s(t.onDragStart({active:x}))},onDragMove(p){let{active:x,over:m}=p;t.onDragMove&&s(t.onDragMove({active:x,over:m}))},onDragOver(p){let{active:x,over:m}=p;s(t.onDragOver({active:x,over:m}))},onDragEnd(p){let{active:x,over:m}=p;s(t.onDragEnd({active:x,over:m}))},onDragCancel(p){let{active:x,over:m}=p;s(t.onDragCancel({active:x,over:m}))}}),[s,t])),!l)return null;const g=H.createElement(H.Fragment,null,H.createElement(Gn,{id:r,value:o.draggable}),H.createElement(Jn,{id:c,announcement:a}));return n?Le.createPortal(g,n):g}var z;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(z||(z={}));function rt(){}function Ee(e,t){return i.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Nt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const re=Object.freeze({x:0,y:0});function ln(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function un(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function rr(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function Kt(e){let{left:t,top:n,height:r,width:o}=e;return[{x:t,y:n},{x:t+o,y:n},{x:t,y:n+r},{x:t+o,y:n+r}]}function dn(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Yt(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const At=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=Yt(t,t.left,t.top),s=[];for(const a of r){const{id:c}=a,l=n.get(c);if(l){const u=ln(Yt(l),o);s.push({id:c,data:{droppableContainer:a,value:u}})}}return s.sort(un)},or=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=Kt(t),s=[];for(const a of r){const{id:c}=a,l=n.get(c);if(l){const u=Kt(l),g=o.reduce((x,m,w)=>x+ln(u[w],m),0),p=Number((g/4).toFixed(4));s.push({id:c,data:{droppableContainer:a,value:p}})}}return s.sort(un)};function sr(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),a=o-r,c=s-n;if(r<o&&n<s){const l=t.width*t.height,u=e.width*e.height,g=a*c,p=g/(l+u-g);return Number(p.toFixed(4))}return 0}const ir=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const s of r){const{id:a}=s,c=n.get(a);if(c){const l=sr(c,t);l>0&&o.push({id:a,data:{droppableContainer:s,value:l}})}}return o.sort(rr)};function ar(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function fn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:re}function cr(e){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return o.reduce((a,c)=>({...a,top:a.top+e*c.y,bottom:a.bottom+e*c.y,left:a.left+e*c.x,right:a.right+e*c.x}),{...n})}}const lr=cr(1);function ur(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function dr(e,t,n){const r=ur(t);if(!r)return e;const{scaleX:o,scaleY:s,x:a,y:c}=r,l=e.left-a-(1-o)*parseFloat(n),u=e.top-c-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),g=o?e.width/o:e.width,p=s?e.height/s:e.height;return{width:g,height:p,top:u,right:l+g,bottom:u+p,left:l}}const fr={ignoreTransform:!1};function Ae(e,t){t===void 0&&(t=fr);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:g}=q(e).getComputedStyle(e);u&&(n=dr(n,u,g))}const{top:r,left:o,width:s,height:a,bottom:c,right:l}=n;return{top:r,left:o,width:s,height:a,bottom:c,right:l}}function Wt(e){return Ae(e,{ignoreTransform:!0})}function pr(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function gr(e,t){return t===void 0&&(t=q(e).getComputedStyle(e)),t.position==="fixed"}function hr(e,t){t===void 0&&(t=q(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const s=t[o];return typeof s=="string"?n.test(s):!1})}function at(e,t){const n=[];function r(o){if(t!=null&&n.length>=t||!o)return n;if(St(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!Xe(o)||sn(o)||n.includes(o))return n;const s=q(e).getComputedStyle(o);return o!==e&&hr(o,s)&&n.push(o),gr(o,s)?n:r(o.parentNode)}return e?r(e):n}function pn(e){const[t]=at(e,1);return t??null}function vt(e){return!it||!e?null:Ie(e)?e:Rt(e)?St(e)||e===Ne(e).scrollingElement?window:Xe(e)?e:null:null}function gn(e){return Ie(e)?e.scrollX:e.scrollLeft}function hn(e){return Ie(e)?e.scrollY:e.scrollTop}function yt(e){return{x:gn(e),y:hn(e)}}var U;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(U||(U={}));function vn(e){return!it||!e?!1:e===document.scrollingElement}function bn(e){const t={x:0,y:0},n=vn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,c=e.scrollLeft>=r.x;return{isTop:o,isLeft:s,isBottom:a,isRight:c,maxScroll:r,minScroll:t}}const vr={x:.2,y:.2};function br(e,t,n,r,o){let{top:s,left:a,right:c,bottom:l}=n;r===void 0&&(r=10),o===void 0&&(o=vr);const{isTop:u,isBottom:g,isLeft:p,isRight:x}=bn(e),m={x:0,y:0},w={x:0,y:0},h={height:t.height*o.y,width:t.width*o.x};return!u&&s<=t.top+h.height?(m.y=U.Backward,w.y=r*Math.abs((t.top+h.height-s)/h.height)):!g&&l>=t.bottom-h.height&&(m.y=U.Forward,w.y=r*Math.abs((t.bottom-h.height-l)/h.height)),!x&&c>=t.right-h.width?(m.x=U.Forward,w.x=r*Math.abs((t.right-h.width-c)/h.width)):!p&&a<=t.left+h.width&&(m.x=U.Backward,w.x=r*Math.abs((t.left+h.width-a)/h.width)),{direction:m,speed:w}}function mr(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:a}=window;return{top:0,left:0,right:s,bottom:a,width:s,height:a}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function mn(e){return e.reduce((t,n)=>Se(t,yt(n)),re)}function xr(e){return e.reduce((t,n)=>t+gn(n),0)}function wr(e){return e.reduce((t,n)=>t+hn(n),0)}function yr(e,t){if(t===void 0&&(t=Ae),!e)return;const{top:n,left:r,bottom:o,right:s}=t(e);pn(e)&&(o<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Cr=[["x",["left","right"],xr],["y",["top","bottom"],wr]];class Tt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=at(n),o=mn(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,a,c]of Cr)for(const l of a)Object.defineProperty(this,l,{get:()=>{const u=c(r),g=o[s]-u;return this.rect[l]+g},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Pe{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var o;(o=this.target)==null||o.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function Dr(e){const{EventTarget:t}=q(e);return e instanceof t?e:Ne(e)}function bt(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var te;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(te||(te={}));function Ht(e){e.preventDefault()}function Rr(e){e.stopPropagation()}var M;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(M||(M={}));const xn={start:[M.Space,M.Enter],cancel:[M.Esc],end:[M.Space,M.Enter,M.Tab]},Sr=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case M.Right:return{...n,x:n.x+25};case M.Left:return{...n,x:n.x-25};case M.Down:return{...n,y:n.y+25};case M.Up:return{...n,y:n.y-25}}};class We{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Pe(Ne(n)),this.windowListeners=new Pe(q(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(te.Resize,this.handleCancel),this.windowListeners.add(te.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(te.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&yr(r),n(re)}handleKeyDown(t){if(It(t)){const{active:n,context:r,options:o}=this.props,{keyboardCodes:s=xn,coordinateGetter:a=Sr,scrollBehavior:c="smooth"}=o,{code:l}=t;if(s.end.includes(l)){this.handleEnd(t);return}if(s.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:u}=r.current,g=u?{x:u.left,y:u.top}:re;this.referenceCoordinates||(this.referenceCoordinates=g);const p=a(t,{active:n,context:r.current,currentCoordinates:g});if(p){const x=Ve(p,g),m={x:0,y:0},{scrollableAncestors:w}=r.current;for(const h of w){const f=t.code,{isTop:d,isRight:b,isLeft:v,isBottom:D,maxScroll:S,minScroll:I}=bn(h),y=mr(h),R={x:Math.min(f===M.Right?y.right-y.width/2:y.right,Math.max(f===M.Right?y.left:y.left+y.width/2,p.x)),y:Math.min(f===M.Down?y.bottom-y.height/2:y.bottom,Math.max(f===M.Down?y.top:y.top+y.height/2,p.y))},N=f===M.Right&&!b||f===M.Left&&!v,j=f===M.Down&&!D||f===M.Up&&!d;if(N&&R.x!==p.x){const E=h.scrollLeft+x.x,F=f===M.Right&&E<=S.x||f===M.Left&&E>=I.x;if(F&&!x.y){h.scrollTo({left:E,behavior:c});return}F?m.x=h.scrollLeft-E:m.x=f===M.Right?h.scrollLeft-S.x:h.scrollLeft-I.x,m.x&&h.scrollBy({left:-m.x,behavior:c});break}else if(j&&R.y!==p.y){const E=h.scrollTop+x.y,F=f===M.Down&&E<=S.y||f===M.Up&&E>=I.y;if(F&&!x.x){h.scrollTo({top:E,behavior:c});return}F?m.y=h.scrollTop-E:m.y=f===M.Down?h.scrollTop-S.y:h.scrollTop-I.y,m.y&&h.scrollBy({top:-m.y,behavior:c});break}}this.handleMove(t,Se(Ve(p,this.referenceCoordinates),m))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}We.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=xn,onActivation:o}=t,{active:s}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const c=s.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),o?.({event:e.nativeEvent}),!0)}return!1}}];function qt(e){return!!(e&&"distance"in e)}function Gt(e){return!!(e&&"delay"in e)}class Mt{constructor(t,n,r){var o;r===void 0&&(r=Dr(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:s}=t,{target:a}=s;this.props=t,this.events=n,this.document=Ne(a),this.documentListeners=new Pe(this.document),this.listeners=new Pe(r),this.windowListeners=new Pe(q(a)),this.initialCoordinates=(o=wt(s))!=null?o:re,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(te.Resize,this.handleCancel),this.windowListeners.add(te.DragStart,Ht),this.windowListeners.add(te.VisibilityChange,this.handleCancel),this.windowListeners.add(te.ContextMenu,Ht),this.documentListeners.add(te.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Gt(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(qt(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:o}=this.props;o(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(te.Click,Rr,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(te.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:o,props:s}=this,{onMove:a,options:{activationConstraint:c}}=s;if(!o)return;const l=(n=wt(t))!=null?n:re,u=Ve(o,l);if(!r&&c){if(qt(c)){if(c.tolerance!=null&&bt(u,c.tolerance))return this.handleCancel();if(bt(u,c.distance))return this.handleStart()}if(Gt(c)&&bt(u,c.tolerance))return this.handleCancel();this.handlePending(c,u);return}t.cancelable&&t.preventDefault(),a(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===M.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Er={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class He extends Mt{constructor(t){const{event:n}=t,r=Ne(n.target);super(t,Er,r)}}He.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r?.({event:n}),!0)}}];const Ir={move:{name:"mousemove"},end:{name:"mouseup"}};var Ct;(function(e){e[e.RightClick=2]="RightClick"})(Ct||(Ct={}));class Nr extends Mt{constructor(t){super(t,Ir,Ne(t.event.target))}}Nr.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===Ct.RightClick?!1:(r?.({event:n}),!0)}}];const mt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Ar extends Mt{constructor(t){super(t,mt)}static setup(){return window.addEventListener(mt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(mt.move.name,t)};function t(){}}}Ar.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return o.length>1?!1:(r?.({event:n}),!0)}}];var Be;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Be||(Be={}));var ot;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(ot||(ot={}));function Tr(e){let{acceleration:t,activator:n=Be.Pointer,canScroll:r,draggingRect:o,enabled:s,interval:a=5,order:c=ot.TreeOrder,pointerCoordinates:l,scrollableAncestors:u,scrollableAncestorRects:g,delta:p,threshold:x}=e;const m=jr({delta:p,disabled:!s}),[w,h]=Kn(),f=i.useRef({x:0,y:0}),d=i.useRef({x:0,y:0}),b=i.useMemo(()=>{switch(n){case Be.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Be.DraggableRect:return o}},[n,o,l]),v=i.useRef(null),D=i.useCallback(()=>{const I=v.current;if(!I)return;const y=f.current.x*d.current.x,R=f.current.y*d.current.y;I.scrollBy(y,R)},[]),S=i.useMemo(()=>c===ot.TreeOrder?[...u].reverse():u,[c,u]);i.useEffect(()=>{if(!s||!u.length||!b){h();return}for(const I of S){if(r?.(I)===!1)continue;const y=u.indexOf(I),R=g[y];if(!R)continue;const{direction:N,speed:j}=br(I,R,b,t,x);for(const E of["x","y"])m[E][N[E]]||(j[E]=0,N[E]=0);if(j.x>0||j.y>0){h(),v.current=I,w(D,a),f.current=j,d.current=N;return}}f.current={x:0,y:0},d.current={x:0,y:0},h()},[t,D,r,h,s,a,JSON.stringify(b),JSON.stringify(m),w,u,S,g,JSON.stringify(x)])}const Mr={x:{[U.Backward]:!1,[U.Forward]:!1},y:{[U.Backward]:!1,[U.Forward]:!1}};function jr(e){let{delta:t,disabled:n}=e;const r=xt(t);return Ke(o=>{if(n||!r||!o)return Mr;const s={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[U.Backward]:o.x[U.Backward]||s.x===-1,[U.Forward]:o.x[U.Forward]||s.x===1},y:{[U.Backward]:o.y[U.Backward]||s.y===-1,[U.Forward]:o.y[U.Forward]||s.y===1}}},[n,t,r])}function Fr(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Ke(o=>{var s;return t==null?null:(s=r??o)!=null?s:null},[r,t])}function Or(e,t){return i.useMemo(()=>e.reduce((n,r)=>{const{sensor:o}=r,s=o.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...s]},[]),[e,t])}var Ue;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Ue||(Ue={}));var Dt;(function(e){e.Optimized="optimized"})(Dt||(Dt={}));const Jt=new Map;function kr(e,t){let{dragging:n,dependencies:r,config:o}=t;const[s,a]=i.useState(null),{frequency:c,measure:l,strategy:u}=o,g=i.useRef(e),p=f(),x=ze(p),m=i.useCallback(function(d){d===void 0&&(d=[]),!x.current&&a(b=>b===null?d:b.concat(d.filter(v=>!b.includes(v))))},[x]),w=i.useRef(null),h=Ke(d=>{if(p&&!n)return Jt;if(!d||d===Jt||g.current!==e||s!=null){const b=new Map;for(let v of e){if(!v)continue;if(s&&s.length>0&&!s.includes(v.id)&&v.rect.current){b.set(v.id,v.rect.current);continue}const D=v.node.current,S=D?new Tt(l(D),D):null;v.rect.current=S,S&&b.set(v.id,S)}return b}return d},[e,s,n,p,l]);return i.useEffect(()=>{g.current=e},[e]),i.useEffect(()=>{p||m()},[n,p]),i.useEffect(()=>{s&&s.length>0&&a(null)},[JSON.stringify(s)]),i.useEffect(()=>{p||typeof c!="number"||w.current!==null||(w.current=setTimeout(()=>{m(),w.current=null},c))},[c,p,m,...r]),{droppableRects:h,measureDroppableContainers:m,measuringScheduled:s!=null};function f(){switch(u){case Ue.Always:return!1;case Ue.BeforeDragging:return n;default:return!n}}}function wn(e,t){return Ke(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Lr(e,t){return wn(e,t)}function Pr(e){let{callback:t,disabled:n}=e;const r=Et(t),o=i.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,n]);return i.useEffect(()=>()=>o?.disconnect(),[o]),o}function ct(e){let{callback:t,disabled:n}=e;const r=Et(t),o=i.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[n]);return i.useEffect(()=>()=>o?.disconnect(),[o]),o}function Br(e){return new Tt(Ae(e),e)}function _t(e,t,n){t===void 0&&(t=Br);const[r,o]=i.useState(null);function s(){o(l=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=l??n)!=null?u:null}const g=t(e);return JSON.stringify(l)===JSON.stringify(g)?l:g})}const a=Pr({callback(l){if(e)for(const u of l){const{type:g,target:p}=u;if(g==="childList"&&p instanceof HTMLElement&&p.contains(e)){s();break}}}}),c=ct({callback:s});return ae(()=>{s(),e?(c?.observe(e),a?.observe(document.body,{childList:!0,subtree:!0})):(c?.disconnect(),a?.disconnect())},[e]),r}function $r(e){const t=wn(e);return fn(e,t)}const Qt=[];function zr(e){const t=i.useRef(e),n=Ke(r=>e?r&&r!==Qt&&e&&t.current&&e.parentNode===t.current.parentNode?r:at(e):Qt,[e]);return i.useEffect(()=>{t.current=e},[e]),n}function Vr(e){const[t,n]=i.useState(null),r=i.useRef(e),o=i.useCallback(s=>{const a=vt(s.target);a&&n(c=>c?(c.set(a,yt(a)),new Map(c)):null)},[]);return i.useEffect(()=>{const s=r.current;if(e!==s){a(s);const c=e.map(l=>{const u=vt(l);return u?(u.addEventListener("scroll",o,{passive:!0}),[u,yt(u)]):null}).filter(l=>l!=null);n(c.length?new Map(c):null),r.current=e}return()=>{a(e),a(s)};function a(c){c.forEach(l=>{const u=vt(l);u?.removeEventListener("scroll",o)})}},[o,e]),i.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,a)=>Se(s,a),re):mn(e):re,[e,t])}function Zt(e,t){t===void 0&&(t=[]);const n=i.useRef(null);return i.useEffect(()=>{n.current=null},t),i.useEffect(()=>{const r=e!==re;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?Ve(e,n.current):re}function Ur(e){i.useEffect(()=>{if(!it)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n?.()}},e.map(t=>{let{sensor:n}=t;return n}))}function Xr(e,t){return i.useMemo(()=>e.reduce((n,r)=>{let{eventName:o,handler:s}=r;return n[o]=a=>{s(a,t)},n},{}),[e,t])}function yn(e){return i.useMemo(()=>e?pr(e):null,[e])}const en=[];function Kr(e,t){t===void 0&&(t=Ae);const[n]=e,r=yn(n?q(n):null),[o,s]=i.useState(en);function a(){s(()=>e.length?e.map(l=>vn(l)?r:new Tt(t(l),l)):en)}const c=ct({callback:a});return ae(()=>{c?.disconnect(),a(),e.forEach(l=>c?.observe(l))},[e]),o}function Yr(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Xe(t)?t:e}function Wr(e){let{measure:t}=e;const[n,r]=i.useState(null),o=i.useCallback(u=>{for(const{target:g}of u)if(Xe(g)){r(p=>{const x=t(g);return p?{...p,width:x.width,height:x.height}:x});break}},[t]),s=ct({callback:o}),a=i.useCallback(u=>{const g=Yr(u);s?.disconnect(),g&&s?.observe(g),r(g?t(g):null)},[t,s]),[c,l]=tt(a);return i.useMemo(()=>({nodeRef:c,rect:n,setRef:l}),[n,c,l])}const Hr=[{sensor:He,options:{}},{sensor:We,options:{}}],qr={current:{}},et={draggable:{measure:Wt},droppable:{measure:Wt,strategy:Ue.WhileDragging,frequency:Dt.Optimized},dragOverlay:{measure:Ae}};class $e extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const Gr={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new $e,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:rt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:et,measureDroppableContainers:rt,windowRect:null,measuringScheduled:!1},Jr={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:rt,draggableNodes:new Map,over:null,measureDroppableContainers:rt},lt=i.createContext(Jr),Cn=i.createContext(Gr);function _r(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new $e}}}function Qr(e,t){switch(t.type){case z.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case z.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case z.DragEnd:case z.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case z.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new $e(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case z.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const a=new $e(e.droppable.containers);return a.set(n,{...s,disabled:o}),{...e,droppable:{...e.droppable,containers:a}}}case z.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const s=new $e(e.droppable.containers);return s.delete(n),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function Zr(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:o}=i.useContext(lt),s=xt(r),a=xt(n?.id);return i.useEffect(()=>{if(!t&&!r&&s&&a!=null){if(!It(s)||document.activeElement===s.target)return;const c=o.get(a);if(!c)return;const{activatorNode:l,node:u}=c;if(!l.current&&!u.current)return;requestAnimationFrame(()=>{for(const g of[l.current,u.current]){if(!g)continue;const p=Hn(g);if(p){p.focus();break}}})}},[r,t,o,a,s]),null}function eo(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((o,s)=>s({transform:o,...r}),n):n}function to(e){return i.useMemo(()=>({draggable:{...et.draggable,...e?.draggable},droppable:{...et.droppable,...e?.droppable},dragOverlay:{...et.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function no(e){let{activeNode:t,measure:n,initialRect:r,config:o=!0}=e;const s=i.useRef(!1),{x:a,y:c}=typeof o=="boolean"?{x:o,y:o}:o;ae(()=>{if(!a&&!c||!t){s.current=!1;return}if(s.current||!r)return;const u=t?.node.current;if(!u||u.isConnected===!1)return;const g=n(u),p=fn(g,r);if(a||(p.x=0),c||(p.y=0),s.current=!0,Math.abs(p.x)>0||Math.abs(p.y)>0){const x=pn(u);x&&x.scrollBy({top:p.y,left:p.x})}},[t,a,c,r,n])}const Dn=i.createContext({...re,scaleX:1,scaleY:1});var me;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(me||(me={}));const ut=i.memo(function(t){var n,r,o,s;let{id:a,accessibility:c,autoScroll:l=!0,children:u,sensors:g=Hr,collisionDetection:p=ir,measuring:x,modifiers:m,...w}=t;const h=i.useReducer(Qr,void 0,_r),[f,d]=h,[b,v]=Zn(),[D,S]=i.useState(me.Uninitialized),I=D===me.Initialized,{draggable:{active:y,nodes:R,translate:N},droppable:{containers:j}}=f,E=y!=null?R.get(y):null,F=i.useRef({initial:null,translated:null}),P=i.useMemo(()=>{var Y;return y!=null?{id:y,data:(Y=E?.data)!=null?Y:qr,rect:F}:null},[y,E]),T=i.useRef(null),[A,B]=i.useState(null),[V,G]=i.useState(null),L=ze(w,Object.values(w)),X=Ye("DndDescribedBy",a),W=i.useMemo(()=>j.getEnabled(),[j]),O=to(x),{droppableRects:$,measureDroppableContainers:ne,measuringScheduled:Te}=kr(W,{dragging:I,dependencies:[N.x,N.y],config:O.droppable}),Z=Fr(R,y),Ge=i.useMemo(()=>V?wt(V):null,[V]),fe=$n(),ce=Lr(Z,O.draggable.measure);no({activeNode:y!=null?R.get(y):null,config:fe.layoutShiftCompensation,initialRect:ce,measure:O.draggable.measure});const k=_t(Z,O.draggable.measure,ce),Me=_t(Z?Z.parentElement:null),oe=i.useRef({activatorEvent:null,active:null,activeNode:Z,collisionRect:null,collisions:null,droppableRects:$,draggableNodes:R,draggingNode:null,draggingNodeRect:null,droppableContainers:j,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),xe=j.getNodeFor((n=oe.current.over)==null?void 0:n.id),le=Wr({measure:O.dragOverlay.measure}),we=(r=le.nodeRef.current)!=null?r:Z,ye=I?(o=le.rect)!=null?o:k:null,kt=!!(le.nodeRef.current&&le.rect),Lt=$r(kt?null:k),ft=yn(we?q(we):null),pe=zr(I?xe??Z:null),Je=Kr(pe),_e=eo(m,{transform:{x:N.x-Lt.x,y:N.y-Lt.y,scaleX:1,scaleY:1},activatorEvent:V,active:P,activeNodeRect:k,containerNodeRect:Me,draggingNodeRect:ye,over:oe.current.over,overlayNodeRect:le.rect,scrollableAncestors:pe,scrollableAncestorRects:Je,windowRect:ft}),Pt=Ge?Se(Ge,N):null,Bt=Vr(pe),jn=Zt(Bt),Fn=Zt(Bt,[k]),Ce=Se(_e,jn),De=ye?lr(ye,_e):null,je=P&&De?p({active:P,collisionRect:De,droppableRects:$,droppableContainers:W,pointerCoordinates:Pt}):null,$t=dn(je,"id"),[ge,zt]=i.useState(null),On=kt?_e:Se(_e,Fn),kn=ar(On,(s=ge?.rect)!=null?s:null,k),pt=i.useRef(null),Vt=i.useCallback((Y,J)=>{let{sensor:_,options:he}=J;if(T.current==null)return;const ee=R.get(T.current);if(!ee)return;const Q=Y.nativeEvent,se=new _({active:T.current,activeNode:ee,event:Q,options:he,context:oe,onAbort(K){if(!R.get(K))return;const{onDragAbort:ie}=L.current,ue={id:K};ie?.(ue),b({type:"onDragAbort",event:ue})},onPending(K,ve,ie,ue){if(!R.get(K))return;const{onDragPending:Oe}=L.current,be={id:K,constraint:ve,initialCoordinates:ie,offset:ue};Oe?.(be),b({type:"onDragPending",event:be})},onStart(K){const ve=T.current;if(ve==null)return;const ie=R.get(ve);if(!ie)return;const{onDragStart:ue}=L.current,Fe={activatorEvent:Q,active:{id:ve,data:ie.data,rect:F}};Le.unstable_batchedUpdates(()=>{ue?.(Fe),S(me.Initializing),d({type:z.DragStart,initialCoordinates:K,active:ve}),b({type:"onDragStart",event:Fe}),B(pt.current),G(Q)})},onMove(K){d({type:z.DragMove,coordinates:K})},onEnd:Re(z.DragEnd),onCancel:Re(z.DragCancel)});pt.current=se;function Re(K){return async function(){const{active:ie,collisions:ue,over:Fe,scrollAdjustedTranslate:Oe}=oe.current;let be=null;if(ie&&Oe){const{cancelDrop:ke}=L.current;be={activatorEvent:Q,active:ie,collisions:ue,delta:Oe,over:Fe},K===z.DragEnd&&typeof ke=="function"&&await Promise.resolve(ke(be))&&(K=z.DragCancel)}T.current=null,Le.unstable_batchedUpdates(()=>{d({type:K}),S(me.Uninitialized),zt(null),B(null),G(null),pt.current=null;const ke=K===z.DragEnd?"onDragEnd":"onDragCancel";if(be){const gt=L.current[ke];gt?.(be),b({type:ke,event:be})}})}}},[R]),Ln=i.useCallback((Y,J)=>(_,he)=>{const ee=_.nativeEvent,Q=R.get(he);if(T.current!==null||!Q||ee.dndKit||ee.defaultPrevented)return;const se={active:Q};Y(_,J.options,se)===!0&&(ee.dndKit={capturedBy:J.sensor},T.current=he,Vt(_,J))},[R,Vt]),Ut=Or(g,Ln);Ur(g),ae(()=>{k&&D===me.Initializing&&S(me.Initialized)},[k,D]),i.useEffect(()=>{const{onDragMove:Y}=L.current,{active:J,activatorEvent:_,collisions:he,over:ee}=oe.current;if(!J||!_)return;const Q={active:J,activatorEvent:_,collisions:he,delta:{x:Ce.x,y:Ce.y},over:ee};Le.unstable_batchedUpdates(()=>{Y?.(Q),b({type:"onDragMove",event:Q})})},[Ce.x,Ce.y]),i.useEffect(()=>{const{active:Y,activatorEvent:J,collisions:_,droppableContainers:he,scrollAdjustedTranslate:ee}=oe.current;if(!Y||T.current==null||!J||!ee)return;const{onDragOver:Q}=L.current,se=he.get($t),Re=se&&se.rect.current?{id:se.id,rect:se.rect.current,data:se.data,disabled:se.disabled}:null,K={active:Y,activatorEvent:J,collisions:_,delta:{x:ee.x,y:ee.y},over:Re};Le.unstable_batchedUpdates(()=>{zt(Re),Q?.(K),b({type:"onDragOver",event:K})})},[$t]),ae(()=>{oe.current={activatorEvent:V,active:P,activeNode:Z,collisionRect:De,collisions:je,droppableRects:$,draggableNodes:R,draggingNode:we,draggingNodeRect:ye,droppableContainers:j,over:ge,scrollableAncestors:pe,scrollAdjustedTranslate:Ce},F.current={initial:ye,translated:De}},[P,Z,je,De,R,we,ye,$,j,ge,pe,Ce]),Tr({...fe,delta:N,draggingRect:De,pointerCoordinates:Pt,scrollableAncestors:pe,scrollableAncestorRects:Je});const Pn=i.useMemo(()=>({active:P,activeNode:Z,activeNodeRect:k,activatorEvent:V,collisions:je,containerNodeRect:Me,dragOverlay:le,draggableNodes:R,droppableContainers:j,droppableRects:$,over:ge,measureDroppableContainers:ne,scrollableAncestors:pe,scrollableAncestorRects:Je,measuringConfiguration:O,measuringScheduled:Te,windowRect:ft}),[P,Z,k,V,je,Me,le,R,j,$,ge,ne,pe,Je,O,Te,ft]),Bn=i.useMemo(()=>({activatorEvent:V,activators:Ut,active:P,activeNodeRect:k,ariaDescribedById:{draggable:X},dispatch:d,draggableNodes:R,over:ge,measureDroppableContainers:ne}),[V,Ut,P,k,d,X,R,ge,ne]);return H.createElement(cn.Provider,{value:v},H.createElement(lt.Provider,{value:Bn},H.createElement(Cn.Provider,{value:Pn},H.createElement(Dn.Provider,{value:kn},u)),H.createElement(Zr,{disabled:c?.restoreFocus===!1})),H.createElement(nr,{...c,hiddenTextDescribedById:X}));function $n(){const Y=A?.autoScrollEnabled===!1,J=typeof l=="object"?l.enabled===!1:l===!1,_=I&&!Y&&!J;return typeof l=="object"?{...l,enabled:_}:{enabled:_}}}),ro=i.createContext(null),tn="button",oo="Draggable";function dt(e){let{id:t,data:n,disabled:r=!1,attributes:o}=e;const s=Ye(oo),{activators:a,activatorEvent:c,active:l,activeNodeRect:u,ariaDescribedById:g,draggableNodes:p,over:x}=i.useContext(lt),{role:m=tn,roleDescription:w="draggable",tabIndex:h=0}=o??{},f=l?.id===t,d=i.useContext(f?Dn:ro),[b,v]=tt(),[D,S]=tt(),I=Xr(a,t),y=ze(n);ae(()=>(p.set(t,{id:t,key:s,node:b,activatorNode:D,data:y}),()=>{const N=p.get(t);N&&N.key===s&&p.delete(t)}),[p,t]);const R=i.useMemo(()=>({role:m,tabIndex:h,"aria-disabled":r,"aria-pressed":f&&m===tn?!0:void 0,"aria-roledescription":w,"aria-describedby":g.draggable}),[r,m,h,f,w,g.draggable]);return{active:l,activatorEvent:c,activeNodeRect:u,attributes:R,isDragging:f,listeners:r?void 0:I,node:b,over:x,setNodeRef:v,setActivatorNodeRef:S,transform:d}}function so(){return i.useContext(Cn)}const io="Droppable",ao={timeout:25};function Rn(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:o}=e;const s=Ye(io),{active:a,dispatch:c,over:l,measureDroppableContainers:u}=i.useContext(lt),g=i.useRef({disabled:n}),p=i.useRef(!1),x=i.useRef(null),m=i.useRef(null),{disabled:w,updateMeasurementsFor:h,timeout:f}={...ao,...o},d=ze(h??r),b=i.useCallback(()=>{if(!p.current){p.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{u(Array.isArray(d.current)?d.current:[d.current]),m.current=null},f)},[f]),v=ct({callback:b,disabled:w||!a}),D=i.useCallback((R,N)=>{v&&(N&&(v.unobserve(N),p.current=!1),R&&v.observe(R))},[v]),[S,I]=tt(D),y=ze(t);return i.useEffect(()=>{!v||!S.current||(v.disconnect(),p.current=!1,v.observe(S.current))},[S,v]),i.useEffect(()=>(c({type:z.RegisterDroppable,element:{id:r,key:s,disabled:n,node:S,rect:x,data:y}}),()=>c({type:z.UnregisterDroppable,key:s,id:r})),[r]),i.useEffect(()=>{n!==g.current.disabled&&(c({type:z.SetDroppableDisabled,id:r,key:s,disabled:n}),g.current.disabled=n)},[r,s,n,c]),{active:a,rect:x,isOver:l?.id===r,node:S,over:l,setNodeRef:I}}function qe(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function co(e,t){return e.reduce((n,r,o)=>{const s=t.get(r);return s&&(n[o]=s),n},Array(e.length))}function Qe(e){return e!==null&&e>=0}function lo(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function uo(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Sn=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const s=qe(t,r,n),a=t[o],c=s[o];return!c||!a?null:{x:c.left-a.left,y:c.top-a.top,scaleX:c.width/a.width,scaleY:c.height/a.height}},Ze={scaleX:1,scaleY:1},jt=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:o,rects:s,overIndex:a}=e;const c=(t=s[n])!=null?t:r;if(!c)return null;if(o===n){const u=s[a];return u?{x:0,y:n<a?u.top+u.height-(c.top+c.height):u.top-c.top,...Ze}:null}const l=fo(s,o,n);return o>n&&o<=a?{x:0,y:-c.height-l,...Ze}:o<n&&o>=a?{x:0,y:c.height+l,...Ze}:{x:0,y:0,...Ze}};function fo(e,t,n){const r=e[t],o=e[t-1],s=e[t+1];return r?n<t?o?r.top-(o.top+o.height):s?s.top-(r.top+r.height):0:s?s.top-(r.top+r.height):o?r.top-(o.top+o.height):0:0}const En="Sortable",In=H.createContext({activeIndex:-1,containerId:En,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Sn,disabled:{draggable:!1,droppable:!1}});function Ft(e){let{children:t,id:n,items:r,strategy:o=Sn,disabled:s=!1}=e;const{active:a,dragOverlay:c,droppableRects:l,over:u,measureDroppableContainers:g}=so(),p=Ye(En,n),x=c.rect!==null,m=i.useMemo(()=>r.map(I=>typeof I=="object"&&"id"in I?I.id:I),[r]),w=a!=null,h=a?m.indexOf(a.id):-1,f=u?m.indexOf(u.id):-1,d=i.useRef(m),b=!lo(m,d.current),v=f!==-1&&h===-1||b,D=uo(s);ae(()=>{b&&w&&g(m)},[b,m,w,g]),i.useEffect(()=>{d.current=m},[m]);const S=i.useMemo(()=>({activeIndex:h,containerId:p,disabled:D,disableTransforms:v,items:m,overIndex:f,useDragOverlay:x,sortedRects:co(m,l),strategy:o}),[h,p,D.draggable,D.droppable,v,m,f,l,x,o]);return H.createElement(In.Provider,{value:S},t)}const po=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return qe(n,r,o).indexOf(t)},go=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:s,newIndex:a,previousItems:c,previousContainerId:l,transition:u}=e;return!u||!r||c!==s&&o===a?!1:n?!0:a!==o&&t===l},ho={duration:200,easing:"ease"},Nn="transform",vo=nt.Transition.toString({property:Nn,duration:0,easing:"linear"}),bo={roleDescription:"sortable"};function mo(e){let{disabled:t,index:n,node:r,rect:o}=e;const[s,a]=i.useState(null),c=i.useRef(n);return ae(()=>{if(!t&&n!==c.current&&r.current){const l=o.current;if(l){const u=Ae(r.current,{ignoreTransform:!0}),g={x:l.left-u.left,y:l.top-u.top,scaleX:l.width/u.width,scaleY:l.height/u.height};(g.x||g.y)&&a(g)}}n!==c.current&&(c.current=n)},[t,n,r,o]),i.useEffect(()=>{s&&a(null)},[s]),s}function An(e){let{animateLayoutChanges:t=go,attributes:n,disabled:r,data:o,getNewIndex:s=po,id:a,strategy:c,resizeObserverConfig:l,transition:u=ho}=e;const{items:g,containerId:p,activeIndex:x,disabled:m,disableTransforms:w,sortedRects:h,overIndex:f,useDragOverlay:d,strategy:b}=i.useContext(In),v=xo(r,m),D=g.indexOf(a),S=i.useMemo(()=>({sortable:{containerId:p,index:D,items:g},...o}),[p,o,D,g]),I=i.useMemo(()=>g.slice(g.indexOf(a)),[g,a]),{rect:y,node:R,isOver:N,setNodeRef:j}=Rn({id:a,data:S,disabled:v.droppable,resizeObserverConfig:{updateMeasurementsFor:I,...l}}),{active:E,activatorEvent:F,activeNodeRect:P,attributes:T,setNodeRef:A,listeners:B,isDragging:V,over:G,setActivatorNodeRef:L,transform:X}=dt({id:a,data:S,attributes:{...bo,...n},disabled:v.draggable}),W=Xn(j,A),O=!!E,$=O&&!w&&Qe(x)&&Qe(f),ne=!d&&V,Te=ne&&$?X:null,Ge=$?Te??(c??b)({rects:h,activeNodeRect:P,activeIndex:x,overIndex:f,index:D}):null,fe=Qe(x)&&Qe(f)?s({id:a,items:g,activeIndex:x,overIndex:f}):D,ce=E?.id,k=i.useRef({activeId:ce,items:g,newIndex:fe,containerId:p}),Me=g!==k.current.items,oe=t({active:E,containerId:p,isDragging:V,isSorting:O,id:a,index:D,items:g,newIndex:k.current.newIndex,previousItems:k.current.items,previousContainerId:k.current.containerId,transition:u,wasDragging:k.current.activeId!=null}),xe=mo({disabled:!oe,index:D,node:R,rect:y});return i.useEffect(()=>{O&&k.current.newIndex!==fe&&(k.current.newIndex=fe),p!==k.current.containerId&&(k.current.containerId=p),g!==k.current.items&&(k.current.items=g)},[O,fe,p,g]),i.useEffect(()=>{if(ce===k.current.activeId)return;if(ce!=null&&k.current.activeId==null){k.current.activeId=ce;return}const we=setTimeout(()=>{k.current.activeId=ce},50);return()=>clearTimeout(we)},[ce]),{active:E,activeIndex:x,attributes:T,data:S,rect:y,index:D,newIndex:fe,items:g,isOver:N,isSorting:O,isDragging:V,listeners:B,node:R,overIndex:f,over:G,setNodeRef:W,setActivatorNodeRef:L,setDroppableNodeRef:j,setDraggableNodeRef:A,transform:xe??Ge,transition:le()};function le(){if(xe||Me&&k.current.newIndex===D)return vo;if(!(ne&&!It(F)||!u)&&(O||oe))return nt.Transition.toString({...u,property:Nn})}}function xo(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e?.draggable)!=null?n:t.draggable,droppable:(r=e?.droppable)!=null?r:t.droppable}}function st(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const wo=[M.Down,M.Right,M.Up,M.Left],Ot=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:o,droppableContainers:s,over:a,scrollableAncestors:c}}=t;if(wo.includes(e.code)){if(e.preventDefault(),!n||!r)return;const l=[];s.getEnabled().forEach(p=>{if(!p||p!=null&&p.disabled)return;const x=o.get(p.id);if(x)switch(e.code){case M.Down:r.top<x.top&&l.push(p);break;case M.Up:r.top>x.top&&l.push(p);break;case M.Left:r.left>x.left&&l.push(p);break;case M.Right:r.left<x.left&&l.push(p);break}});const u=or({active:n,collisionRect:r,droppableRects:o,droppableContainers:l,pointerCoordinates:null});let g=dn(u,"id");if(g===a?.id&&u.length>1&&(g=u[1].id),g!=null){const p=s.get(n.id),x=s.get(g),m=x?o.get(x.id):null,w=x?.node.current;if(w&&m&&p&&x){const f=at(w).some((I,y)=>c[y]!==I),d=Tn(p,x),b=yo(p,x),v=f||!d?{x:0,y:0}:{x:b?r.width-m.width:0,y:b?r.height-m.height:0},D={x:m.left,y:m.top};return v.x&&v.y?D:Ve(D,v)}}}};function Tn(e,t){return!st(e)||!st(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function yo(e,t){return!st(e)||!st(t)||!Tn(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}function Mn({id:e,content:t}){const{attributes:n,listeners:r,setNodeRef:o,setActivatorNodeRef:s,transform:a,transition:c,isDragging:l}=An({id:e}),u=i.useRef(null),{changeFunctionName:g,getFunctionName:p}=i.useContext(de),[x,m]=i.useState(t),w=f=>{m(f.target.value),g(e,f.target.value)},h=a?{transform:`translate3d(${a.x}px, ${a.y}px, 0)`,opacity:l?.6:1}:{};return C.jsxs("div",{id:e,ref:o,style:{...h},className:"mb-4 flex h-12 w-64 place-items-center rounded-lg border border-black bg-white font-medium text-black text-sm",...n,children:[C.jsx("input",{type:"text",ref:u,value:x,onChange:w,className:"ml-4",onKeyDown:f=>{f.stopPropagation(),f.key==="Enter"&&u.current&&u.current.blur()}}),C.jsx("div",{style:{cursor:"grab"},...r,className:"mr-4 flex w-full justify-end",children:C.jsx("span",{children:":::"})})]})}function Co({id:e,content:t}){const{attributes:n,listeners:r,setNodeRef:o,setActivatorNodeRef:s,transform:a,transition:c,isDragging:l}=An({id:e});i.useRef(null);const{contracts:u,delFunctionContract:g,updatePosition:p,functions:x}=i.useContext(de),{changeFunctionName:m,getFunctionName:w,changeFunctionView:h,getFunctionView:f}=i.useContext(de),[d,b]=i.useState(w(e)),[v,D]=i.useState(f(e)),[S,I]=i.useState([]),[y,R]=i.useState([{id:"1",name:"Variable 1",content:"Variable 1"},{id:"2",name:"Variable 2",content:"Variable 1"},{id:"3",name:"Variable 3",content:"Variable 1"}]);i.useEffect(()=>{const T=u.find(A=>A.props.id===e);T&&(I(T.props.functions),R(S))},[u,e,S]);const N=T=>{b(T.target.value),m(e,T.target.value)},j=i.useRef(null),E=Nt(Ee(He),Ee(We,{coordinateGetter:Ot})),F=i.useRef(null),P=T=>{const{active:A,over:B,delta:V}=T,G=A.rect.current.translated;if(G&&F.current){const L=F.current.getBoundingClientRect();if(G.left<L.left||G.right>L.right||G.top<L.top||G.bottom>L.bottom){g(e,A.id.toString()),x.find(W=>W.props.id===A.id)&&p(A.id.toString(),G.left,G.top),I(W=>W.filter($=>$.id!==A.id)),R(W=>W.filter($=>$.id!==A.id));return}}B&&A?.id!==B?.id&&R(L=>{const X=L.findIndex(O=>O.id===A?.id),W=L.findIndex(O=>O.id===B?.id);return qe(L,X,W)})};return C.jsxs("div",{id:e,ref:o,style:{transform:a?`translate3d(${a.x}px, ${a.y}px, 0)`:void 0,opacity:l?.6:1},className:"my-4 flex h-fit w-80 flex-col rounded-lg border border-black bg-white font-medium text-black text-sm",...n,children:[C.jsxs("div",{className:"mt-2 flex h-12 w-full flex-row items-center justify-start",children:[v?C.jsx(on,{onClick:()=>{D(!1),h(e,!1)},className:"ml-2 w-16"}):C.jsx(rn,{onClick:()=>{D(!0),h(e,!0)},className:"ml-2 w-16"}),C.jsx("input",{type:"text",ref:j,value:d,onChange:N,className:"ml-4",onKeyDown:T=>{T.stopPropagation(),T.key==="Enter"&&j.current&&j.current.blur()}}),C.jsx("div",{style:{cursor:"grab"},...r,className:"mr-4 flex w-full justify-end",children:C.jsx("span",{children:":::"})})]}),v?C.jsx("div",{className:"my-8 flex justify-center",children:C.jsx(ut,{sensors:E,collisionDetection:At,onDragEnd:P,children:C.jsx(Ft,{items:y,strategy:jt,children:C.jsx("ul",{children:y.map(T=>C.jsx(Mn,{id:T.id,content:T.name,name:T.name},T.id))})})})}):C.jsx("div",{className:"my-2"})]})}function Do({id:e,name:t,position:n}){const{attributes:r,listeners:o,setNodeRef:s,transform:a,isDragging:c}=dt({id:e}),{contracts:l,delFunctionContract:u,updatePosition:g}=i.useContext(de),p=i.useRef(null),x=Nt(Ee(He),Ee(We,{coordinateGetter:Ot})),m=i.useRef(null),w=y=>{const{active:R,over:N,delta:j}=y;console.log("end drag !!!");const E=R.rect.current.translated;if(E&&m.current){const F=m.current.getBoundingClientRect();if(E.left<F.left||E.right>F.right||E.top<F.top||E.bottom>F.bottom){u(e,R.id.toString()),f.find(T=>T.id===R.id)&&g(R.id.toString(),E.left,E.top),d(T=>T.filter(B=>B.id!==R.id)),v(T=>T.filter(B=>B.id!==R.id));return}}N&&R?.id!==N?.id&&v(F=>{const P=F.findIndex(A=>A.id===R?.id),T=F.findIndex(A=>A.id===N?.id);return qe(F,P,T)})},h=y=>{console.log("start drag !!!")},[f,d]=i.useState([]);i.useEffect(()=>{const y=l.find(R=>R.props.id===e);y&&(d(y.props.functions),v(f))},[l,e,f]);const[b,v]=i.useState(f),[D,S]=i.useState(t),I=y=>{S(y.target.value)};return C.jsxs("div",{id:e,ref:m,style:{transform:a?`translate3d(${a.x}px, ${a.y}px, 0)`:void 0,left:`${n.x}px`,top:`${n.y}px`,position:"absolute",opacity:c?.6:1},className:"flex h-fit w-96 flex-col rounded-lg border-2 border-black bg-white font-medium text-black text-sm",...r,children:[C.jsxs("div",{className:"mt-4 flex h-12 w-full flex-row items-center justify-start",children:[C.jsx("input",{type:"text",ref:p,value:D,onChange:I,className:"ml-4",onKeyDown:y=>{y.stopPropagation(),y.key==="Enter"&&p.current&&p.current.blur()}}),C.jsx("div",{style:{cursor:"grab"},...o,className:"mr-4 flex w-full justify-end",children:C.jsx("span",{children:":::"})})]}),C.jsx("div",{className:"my-8 flex justify-center",children:C.jsx(ut,{sensors:x,collisionDetection:At,onDragEnd:w,onDragStart:h,children:C.jsx(Ft,{items:b,strategy:jt,children:C.jsx("ul",{children:b.map(y=>C.jsx(Co,{id:y.id,content:y.name,name:y.name,variables:y.variables},y.id))})})})})]})}function Ro({id:e,content:t,name:n,position:r}){const{attributes:o,listeners:s,setNodeRef:a,setActivatorNodeRef:c,transform:l,isDragging:u}=dt({id:e});i.useRef(null);const{contracts:g,delFunctionContract:p,updatePosition:x,functions:m}=i.useContext(de),{changeFunctionName:w,getFunctionName:h,changeFunctionView:f,getFunctionView:d}=i.useContext(de),[b,v]=i.useState(h(e)),[D,S]=i.useState(d(e)),[I,y]=i.useState([]),[R,N]=i.useState([{id:"1",name:"Variable 1",content:"Variable 1"},{id:"2",name:"Variable 2",content:"Variable 1"},{id:"3",name:"Variable 3",content:"Variable 1"}]);i.useEffect(()=>{const A=g.find(B=>B.props.id===e);A&&(y(A.props.functions),N(I))},[g,e,I]);const j=A=>{v(A.target.value),w(e,A.target.value)},E=i.useRef(null),F=Nt(Ee(He),Ee(We,{coordinateGetter:Ot})),P=i.useRef(null),T=A=>{const{active:B,over:V,delta:G}=A,L=B.rect.current.translated;if(L&&P.current){const X=P.current.getBoundingClientRect();if(L.left<X.left||L.right>X.right||L.top<X.top||L.bottom>X.bottom){m.find(O=>O.props.id===B.id)&&x(B.id.toString(),L.left,L.top),y(O=>O.filter(ne=>ne.id!==B.id)),N(O=>O.filter(ne=>ne.id!==B.id));return}}V&&B?.id!==V?.id&&N(X=>{const W=X.findIndex($=>$.id===B?.id),O=X.findIndex($=>$.id===V?.id);return qe(X,W,O)})};return C.jsxs("div",{id:e,ref:P,style:{transform:l?`translate3d(${l.x}px, ${l.y}px, 0)`:void 0,left:`${r.x}px`,top:`${r.y}px`,position:"absolute",opacity:u?.6:1},className:"flex h-fit w-80 flex-col rounded-lg border-2 border-black bg-white font-medium text-black text-sm",...o,children:[C.jsxs("div",{className:"mt-2 flex h-12 w-full flex-row items-center justify-start",children:[D?C.jsx(on,{onClick:()=>{S(!1),f(e,!1)},className:"ml-2 w-16"}):C.jsx(rn,{onClick:()=>{S(!0),f(e,!0)},className:"ml-2 w-16"}),C.jsx("input",{type:"text",ref:E,value:b,onChange:j,className:"ml-2",onKeyDown:A=>{A.stopPropagation(),A.key==="Enter"&&E.current&&E.current.blur()}}),C.jsx("div",{style:{cursor:"grab"},...s,className:"mr-4 flex w-full justify-end",children:C.jsx("span",{children:":::"})})]}),D?C.jsx("div",{className:"my-8 flex justify-center",children:C.jsx(ut,{sensors:F,collisionDetection:At,onDragEnd:T,children:C.jsx(Ft,{items:R,strategy:jt,children:C.jsx("ul",{children:R.map(A=>C.jsx(Mn,{id:A.id,content:A.name,name:A.name},A.id))})})})}):C.jsx("div",{className:"my-2"})]})}function So({id:e,content:t,name:n,position:r}){const{attributes:o,listeners:s,setNodeRef:a,setActivatorNodeRef:c,transform:l}=dt({id:e}),u=i.useRef(null),{changeFunctionName:g,getFunctionName:p}=i.useContext(de),[x,m]=i.useState(p(e)),w=h=>{m(h.target.value),g(e,h.target.value)};return C.jsxs("div",{id:e,ref:a,style:{transform:l?`translate3d(${l.x}px, ${l.y}px, 0)`:void 0,left:`${r.x}px`,top:`${r.y}px`,position:"absolute"},className:"absolute mb-4 flex h-12 w-64 place-items-center rounded-lg border border-black bg-white font-medium text-black text-sm",...o,children:[C.jsx("input",{type:"text",ref:u,value:x,onChange:w,className:"ml-4",onKeyDown:h=>{h.stopPropagation(),h.key==="Enter"&&u.current&&u.current.blur()}}),C.jsx("div",{style:{cursor:"grab"},...s,className:"mr-4 flex w-full justify-end",children:C.jsx("span",{children:":::"})})]})}const Eo={display:"flex"};function Io({children:e}){const{isOver:t,setNodeRef:n}=Rn({id:"droppable"}),r={color:t?"green":void 0};return C.jsx("div",{ref:n,style:{...r,...Eo},children:e})}const No=["contract","function"];function Ao({draggable:e}){if(e.content==="function")return C.jsx(Ro,{...e.props});if(e.content==="contract")return C.jsx(Do,{...e.props});if(e.content==="variable")return C.jsx(So,{...e.props});throw Error("Invalid draggable")}const To=e=>{if(e.content==="function")return{...e,props:{id:e.props.id,content:e.content,name:e.content,position:e.props.position}};if(e.content==="contract")return{...e,props:{id:e.props.id,content:e.content,name:e.content,position:e.props.position}};if(e.content==="variable")return{...e,props:{id:e.props.id,content:e.content,name:e.content,position:e.props.position}};throw Error("Invalid content")};function Mo(){const{contracts:e,functions:t,addContract:n,addFunctionToContract:r,addFunction:o,getFunctionName:s,updatePosition:a}=i.useContext(de),[c,l]=i.useState([]);i.useEffect(()=>{const f=e.map(v=>({content:v.content,props:{id:v.props.id,name:v.props.name,content:v.props.content,position:v.props.position,functions:v.props.functions,variables:v.props.variables}})),d=t.map(v=>({content:v.content,props:{id:v.props.id,name:v.props.name,content:v.props.content,position:v.props.position,variables:v.props.variables,viewInside:v.props.viewInside}})),b=[...f,...d];l(b)},[e,t]);const u=i.useRef(null);function g(f){const{active:d}=f;c.find(b=>b.props.id===d.id)}function p(f){const{active:d,delta:b}=f,v=c.find(N=>N.props.id===d.id);if(console.log(v),!v||!u.current)return;const D={x:v.props.position.x+b.x,y:v.props.position.y+b.y},S=c.filter(N=>N.content==="contract");if(v.content==="function")for(const N of S){const j=document.getElementById(v.props.id),E=document.getElementById(N.props.id);if(j&&E){const F=j.getBoundingClientRect(),P=E.getBoundingClientRect();if(F.left<P.right&&F.right>P.left&&F.top<P.bottom&&F.bottom>P.top){console.log("Le DraggableFunction est au-dessus du DraggableContract."),l(A=>A.filter(B=>B.props.id!==v.props.id)),w(N.props.id,v);return}}}const I=u.current.getBoundingClientRect(),R=document.getElementById(v.props.id)?.getBoundingClientRect();if(R&&D.x>=I.left&&D.x+R.width<=I.right&&D.y>=I.top&&D.y+R.height<=I.bottom){const N={...v,position:D};N.props.position=D,a(d.id.toString(),D.x,D.y),l(j=>j.map(E=>E.props.id===N.props.id?N:E))}else console.log("Drag annul : l'lment n'est pas entirement  l'intrieur de la zone droppable.")}const x=(f,d,b)=>{const v={content:"contract",props:{id:f,name:"contract",content:"contract",position:{x:d,y:b},functions:[],variables:[]}};console.log("call addContract"),n(v)},m=(f,d,b)=>{o({content:"function",props:{id:f,name:"function",content:"function",position:{x:d,y:b},variables:[],viewInside:!0}})},w=(f,d)=>{const b={content:"function",props:{id:d.props.id,name:s(d.props.id),content:d.props.content,position:d.props.position,variables:d.props.variables,viewInside:d.props.viewInside}};r(f,b)};function h(f){if(u.current){const d=u.current.getBoundingClientRect(),b=`${f}-${Date.now()}`;f==="contract"?x(b,d.left+25,d.top+25):f==="function"&&m(b,d.left+25,d.top+25);const v=To({content:f,props:{id:b,name:f,content:f,position:{x:d.left+25,y:d.top+25},variables:[]}});l(D=>[...D,v])}}return C.jsxs("div",{className:"flex w-screen flex-row",children:[C.jsx("div",{className:"flex w-1/6 flex-col justify-center gap-4",children:No.map(f=>C.jsx(zn,{className:"mx-4",onClick:()=>h(f),children:f},f))}),C.jsx(ut,{onDragStart:g,onDragEnd:p,children:C.jsx("div",{ref:u,className:"mx-4 h-screen w-full justify-center border-2 border-white",children:C.jsx(Io,{children:c.map(f=>C.jsx(Ao,{draggable:f},f.props.id))})})})]})}const ko=function(){return C.jsx(Un,{children:C.jsx(Mo,{})})};export{ko as component};
