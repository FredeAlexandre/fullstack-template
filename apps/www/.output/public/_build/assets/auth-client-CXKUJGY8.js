import{r as C}from"./client-B6G1yI40.js";let m=[],S=0;const L=4;let Y=e=>{let t=[],r={get(){return r.lc||r.listen(()=>{})(),r.value},lc:0,listen(n){return r.lc=t.push(n),()=>{for(let a=S+L;a<m.length;)m[a]===n?m.splice(a,L):a+=L;let s=t.indexOf(n);~s&&(t.splice(s,1),--r.lc||r.off())}},notify(n,s){let a=!m.length;for(let o of t)m.push(o,r.value,n,s);if(a){for(S=0;S<m.length;S+=L)m[S](m[S+1],m[S+2],m[S+3]);m.length=0}},off(){},set(n){let s=r.value;s!==n&&(r.value=n,r.notify(s))},subscribe(n){let s=r.listen(n);return n(r.value),s},value:e};return r};const re=5,I=6,j=10;let ne=(e,t,r,n)=>(e.events=e.events||{},e.events[r+j]||(e.events[r+j]=n(s=>{e.events[r].reduceRight((a,o)=>(o(a),a),{shared:{},...s})})),e.events[r]=e.events[r]||[],e.events[r].push(t),()=>{let s=e.events[r],a=s.indexOf(t);s.splice(a,1),s.length||(delete e.events[r],e.events[r+j](),delete e.events[r+j])}),se=1e3,oe=(e,t)=>ne(e,n=>{let s=t(n);s&&e.events[I].push(s)},re,n=>{let s=e.listen;e.listen=(...o)=>(!e.lc&&!e.active&&(e.active=!0,n()),s(...o));let a=e.off;return e.events[I]=[],e.off=()=>{a(),setTimeout(()=>{if(e.active&&!e.lc){e.active=!1;for(let o of e.events[I])o();e.events[I]=[]}},se)},()=>{e.listen=s,e.off=a}});function ie(e,t,r){let n=new Set([...t,void 0]);return e.listen((s,a,o)=>{n.has(o)&&r(s,a,o)})}var ae=Object.defineProperty,le=Object.defineProperties,ue=Object.getOwnPropertyDescriptors,B=Object.getOwnPropertySymbols,ce=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable,J=(e,t,r)=>t in e?ae(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,w=(e,t)=>{for(var r in t||(t={}))ce.call(t,r)&&J(e,r,t[r]);if(B)for(var r of B(t))fe.call(t,r)&&J(e,r,t[r]);return e},b=(e,t)=>le(e,ue(t)),de=class extends Error{constructor(e,t,r){super(t||e.toString(),{cause:r}),this.status=e,this.statusText=t,this.error=r}},he=async(e,t)=>{var r,n,s,a,o,c;let l=t||{};const i={onRequest:[t?.onRequest],onResponse:[t?.onResponse],onSuccess:[t?.onSuccess],onError:[t?.onError],onRetry:[t?.onRetry]};if(!t||!t?.plugins)return{url:e,options:l,hooks:i};for(const u of t?.plugins||[]){if(u.init){const h=await((r=u.init)==null?void 0:r.call(u,e.toString(),t));l=h.options||l,e=h.url}i.onRequest.push((n=u.hooks)==null?void 0:n.onRequest),i.onResponse.push((s=u.hooks)==null?void 0:s.onResponse),i.onSuccess.push((a=u.hooks)==null?void 0:a.onSuccess),i.onError.push((o=u.hooks)==null?void 0:o.onError),i.onRetry.push((c=u.hooks)==null?void 0:c.onRetry)}return{url:e,options:l,hooks:i}},G=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},pe=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}};function ye(e){if(typeof e=="number")return new G({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new G(e);case"exponential":return new pe(e);default:throw new Error("Invalid retry strategy")}}var ve=e=>{const t={},r=n=>typeof n=="function"?n():n;if(e?.auth){if(e.auth.type==="Bearer"){const n=r(e.auth.token);if(!n)return t;t.authorization=`Bearer ${n}`}else if(e.auth.type==="Basic"){const n=r(e.auth.username),s=r(e.auth.password);if(!n||!s)return t;t.authorization=`Basic ${btoa(`${n}:${s}`)}`}else if(e.auth.type==="Custom"){const n=r(e.auth.value);if(!n)return t;t.authorization=`${r(e.auth.prefix)} ${n}`}}return t},Z=["get","post","put","patch","delete"],ge=e=>({id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(t,r){var n,s,a,o;const c=((s=(n=e.plugins)==null?void 0:n.find(l=>{var i;return(i=l.schema)!=null&&i.config?t.startsWith(l.schema.config.baseURL||"")||t.startsWith(l.schema.config.prefix||""):!1}))==null?void 0:s.schema)||e.schema;if(c){let l=t;(a=c.config)!=null&&a.prefix&&l.startsWith(c.config.prefix)&&(l=l.replace(c.config.prefix,""),c.config.baseURL&&(t=t.replace(c.config.prefix,c.config.baseURL))),(o=c.config)!=null&&o.baseURL&&l.startsWith(c.config.baseURL)&&(l=l.replace(c.config.baseURL,""));const i=c.schema[l];if(i){let u=b(w({},r),{method:i.method,output:i.output});return r?.disableValidation||(u=b(w({},u),{body:i.input?i.input.parse(r?.body):r?.body,params:i.params?i.params.parse(r?.params):r?.params,query:i.query?i.query.parse(r?.query):r?.query})),{url:t,options:u}}}return{url:t,options:r}}}),me=e=>{async function t(r,n){const s=b(w(w({},e),n),{plugins:[...e?.plugins||[],ge(e||{})]});if(e?.catchAllError)try{return await D(r,s)}catch(a){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:a}}}return await D(r,s)}return t},we=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function be(e){const t=e.headers.get("content-type"),r=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";const n=t.split(";").shift()||"";return we.test(n)?"json":r.has(n)||n.startsWith("text/")?"text":"blob"}function _e(e){try{return JSON.parse(e),!0}catch{return!1}}function X(e){if(e===void 0)return!1;const t=typeof e;return t==="string"||t==="number"||t==="boolean"||t===null?!0:t!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}function V(e){try{return JSON.parse(e)}catch{return e}}function z(e){return typeof e=="function"}function Re(e){if(e?.customFetchImpl)return e.customFetchImpl;if(typeof globalThis<"u"&&z(globalThis.fetch))return globalThis.fetch;if(typeof window<"u"&&z(window.fetch))return window.fetch;throw new Error("No fetch implementation found")}function Te(e){const t=new Headers(e?.headers),r=ve(e);for(const[n,s]of Object.entries(r||{}))t.set(n,s);if(!t.has("content-type")){const n=Se(e?.body);n&&t.set("content-type",n)}return t}function Se(e){return X(e)?"application/json":null}function Oe(e){if(!e?.body)return null;const t=new Headers(e?.headers);return X(e.body)&&!t.has("content-type")?JSON.stringify(e.body):e.body}function Pe(e,t){var r;if(t?.method)return t.method.toUpperCase();if(e.startsWith("@")){const n=(r=e.split("@")[1])==null?void 0:r.split("/")[0];return Z.includes(n)?n.toUpperCase():t?.body?"POST":"GET"}return t?.body?"POST":"GET"}function Ee(e,t){let r;return!e?.signal&&e?.timeout&&(r=setTimeout(()=>t?.abort(),e?.timeout)),{abortTimeout:r,clearTimeout:()=>{r&&clearTimeout(r)}}}function xe(e,t){let{baseURL:r,params:n,query:s}=t||{query:{},params:{},baseURL:""},a=e.startsWith("http")?e.split("/").slice(0,3).join("/"):r;if(!a)throw new TypeError(`Invalid URL ${e}. Are you passing in a relative URL but not setting the baseURL?`);if(e.startsWith("@")){const h=e.toString().split("@")[1].split("/")[0];Z.includes(h)&&(e=e.replace(`@${h}/`,"/"))}a.endsWith("/")||(a+="/");let[o,c]=e.replace(a,"").split("?");const l=new URLSearchParams(c);for(const[h,d]of Object.entries(s||{}))l.set(h,String(d));if(n)if(Array.isArray(n)){const h=o.split("/").filter(d=>d.startsWith(":"));for(const[d,f]of h.entries()){const T=n[d];o=o.replace(f,T)}}else for(const[h,d]of Object.entries(n))o=o.replace(`:${h}`,String(d));o=o.split("/").map(encodeURIComponent).join("/"),o.startsWith("/")&&(o=o.slice(1));let i=l.size>0?`?${l}`.replace(/\+/g,"%20"):"";return new URL(`${o}${i}`,a)}var D=async(e,t)=>{var r,n,s,a,o,c,l,i;const{hooks:u,url:h,options:d}=await he(e,t),f=Re(d),T=new AbortController,q=(r=d.signal)!=null?r:T.signal,O=xe(h,d),A=Oe(d),E=Te(d),P=Pe(h,d);let y=b(w({},d),{url:O,headers:E,body:A,method:P,signal:q});for(const g of u.onRequest)if(g){const v=await g(y);v instanceof Object&&(y=v)}("pipeTo"in y&&typeof y.pipeTo=="function"||typeof((n=t?.body)==null?void 0:n.pipe)=="function")&&("duplex"in y||(y.duplex="half"));const{clearTimeout:$}=Ee(d,T);let p=await f(y.url,y);$();const M={response:p,request:y};for(const g of u.onResponse)if(g){const v=await g(b(w({},M),{response:(s=t?.hookOptions)!=null&&s.cloneResponse?p.clone():p}));v instanceof Response?p=v:v instanceof Object&&(p=v.response)}if(p.ok){if(!(y.method!=="HEAD"))return{data:"",error:null};const v=be(p),_={data:"",response:p,request:y};if(v==="json"||v==="text"){const R=await p.text(),te=await((a=y.jsonParser)!=null?a:V)(R);_.data=te}else _.data=await p[v]();y?.output&&y.output&&!y.disableValidation&&(_.data=y.output.parse(_.data));for(const R of u.onSuccess)R&&await R(b(w({},_),{response:(o=t?.hookOptions)!=null&&o.cloneResponse?p.clone():p}));return t?.throw?_.data:{data:_.data,error:null}}const K=(c=t?.jsonParser)!=null?c:V,W=await p.text(),F=_e(W)?await K(W):{},ee={response:p,request:y,error:b(w({},F),{status:p.status,statusText:p.statusText})};for(const g of u.onError)g&&await g(b(w({},ee),{response:(l=t?.hookOptions)!=null&&l.cloneResponse?p.clone():p}));if(t?.retry){const g=ye(t.retry),v=(i=t.retryAttempt)!=null?i:0;if(await g.shouldAttemptRetry(v,p)){for(const R of u.onRetry)R&&await R(M);const _=g.getDelay(v);return await new Promise(R=>setTimeout(R,_)),await D(e,b(w({},t),{retryAttempt:v+1}))}}if(t?.throw)throw new de(p.status,p.statusText,F);return{data:null,error:b(w({},F),{status:p.status,statusText:p.statusText})}},Ue={},Ae={},k=Object.create(null),x=e=>Ue||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?k:globalThis),Le=new Proxy(k,{get(e,t){return x()[t]??k[t]},has(e,t){let r=x();return t in r||t in k},set(e,t,r){let n=x(!0);return n[t]=r,!0},deleteProperty(e,t){if(!t)return!1;let r=x(!0);return delete r[t],!0},ownKeys(){let e=x(!0);return Object.keys(e)}});function Ie(e){return e?e!=="false":!1}var je=typeof process<"u"&&Ae&&"production"||"";je==="test"||Ie(Le.TEST);var ke=()=>({id:"better-auth-client",$InferServerPlugin:{},pathMethods:{"/admin/list-users":"GET"}}),Ne={},qe={},N=Object.create(null),U=e=>Ne||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?N:globalThis),$e=new Proxy(N,{get(e,t){return U()[t]??N[t]},has(e,t){let r=U();return t in r||t in N},set(e,t,r){let n=U(!0);return n[t]=r,!0},deleteProperty(e,t){if(!t)return!1;let r=U(!0);return delete r[t],!0},ownKeys(){let e=U(!0);return Object.keys(e)}});function Fe(e){return e?e!=="false":!1}var Ce=typeof process<"u"&&qe&&"production"||"";Ce==="test"||Fe($e.TEST);var De=class extends Error{constructor(e,t){super(e),this.name="BetterAuthError",this.message=e,this.cause=t,this.stack=""}};function Me(e){try{return new URL(e).pathname!=="/"}catch{throw new De(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}function We(e,t="/api/auth"){return Me(e)?e:(t=t.startsWith("/")?t:`/${t}`,`${e}${t}`)}function Be(e,t){return We(e,t)}var Je={id:"redirect",name:"Redirect",hooks:{onSuccess(e){if(e.data?.url&&e.data?.redirect&&typeof window<"u"&&window.location&&window.location)try{window.location.href=e.data.url}catch{}}}},Ge={id:"add-current-url",name:"Add current URL",hooks:{onRequest(e){if(typeof window<"u"&&window.location&&window.location)try{let t=new URL(e.url);t.searchParams.set("currentURL",window.location.href),e.url=t}catch{}return e}}},Ve=(e,t,r,n)=>{let s=Y({data:null,error:null,isPending:!0,isRefetching:!1}),a=()=>{let c=typeof n=="function"?n({data:s.get().data,error:s.get().error,isPending:s.get().isPending}):n;return r(t,{...c,async onSuccess(l){s.set({data:l.data,error:null,isPending:!1,isRefetching:!1}),await c?.onSuccess?.(l)},async onError(l){s.set({error:l.error,data:null,isPending:!1,isRefetching:!1}),await c?.onError?.(l)},async onRequest(l){let i=s.get();s.set({isPending:i.data===null,data:i.data,error:null,isRefetching:!0}),await c?.onRequest?.(l)}})};e=Array.isArray(e)?e:[e];let o=!1;for(let c of e)c.subscribe(()=>{o?a():oe(s,()=>(a(),o=!0,()=>{s.off(),c.off()}))});return s};function ze(e){let t=Y(!1);return{session:Ve(t,"/get-session",e,{method:"GET"}),$sessionSignal:t}}var He={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},Qe=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,H={true:!0,false:!1,null:null,undefined:void 0,nan:Number.NaN,infinity:Number.POSITIVE_INFINITY,"-infinity":Number.NEGATIVE_INFINITY},Ye=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/;function Ze(e){return e instanceof Date&&!isNaN(e.getTime())}function Xe(e){let t=Ye.exec(e);if(!t)return null;let[,r,n,s,a,o,c,l,i,u,h]=t,d=new Date(Date.UTC(parseInt(r,10),parseInt(n,10)-1,parseInt(s,10),parseInt(a,10),parseInt(o,10),parseInt(c,10),l?parseInt(l.padEnd(3,"0"),10):0));if(i){let f=(parseInt(u,10)*60+parseInt(h,10))*(i==="+"?-1:1);d.setUTCMinutes(d.getUTCMinutes()+f)}return Ze(d)?d:null}function Ke(e,t={}){let{strict:r=!1,warnings:n=!1,reviver:s,parseDates:a=!0}=t;if(typeof e!="string")return e;let o=e.trim();if(o[0]==='"'&&o.endsWith('"')&&!o.slice(1,-1).includes('"'))return o.slice(1,-1);let c=o.toLowerCase();if(c.length<=9&&c in H)return H[c];if(!Qe.test(o)){if(r)throw new SyntaxError("[better-json] Invalid JSON");return e}if(Object.entries(He).some(([l,i])=>{let u=i.test(o);return u&&n&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${l} pattern`),u})&&r)throw new Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(o,(l,i)=>{if(l==="__proto__"||l==="constructor"&&i&&typeof i=="object"&&"prototype"in i){n&&console.warn(`[better-json] Dropping "${l}" key to prevent prototype pollution`);return}if(a&&typeof i=="string"){let u=Xe(i);if(u)return u}return s?s(l,i):i})}catch(l){if(r)throw l;return e}}function et(e,t={strict:!0}){return Ke(e,t)}var tt=e=>{let t="credentials"in Request.prototype,r=Be(e?.baseURL),n=e?.plugins?.flatMap(f=>f.fetchPlugins).filter(f=>f!==void 0)||[],s=me({baseURL:r,...t?{credentials:"include"}:{},method:"GET",jsonParser(f){return et(f,{strict:!1})},...e?.fetchOptions,plugins:e?.disableDefaultFetchPlugins?[...e?.fetchOptions?.plugins||[],...n]:[Je,Ge,...e?.fetchOptions?.plugins||[],...n]}),{$sessionSignal:a,session:o}=ze(s),c=e?.plugins||[],l={},i={$sessionSignal:a,session:o},u={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"},h=[{signal:"$sessionSignal",matcher(f){return f==="/sign-out"||f==="/update-user"||f.startsWith("/sign-in")||f.startsWith("/sign-up")}}];for(let f of c)f.getAtoms&&Object.assign(i,f.getAtoms?.(s)),f.pathMethods&&Object.assign(u,f.pathMethods),f.atomListeners&&h.push(...f.atomListeners);let d={notify:f=>{i[f].set(!i[f].get())},listen:(f,T)=>{i[f].subscribe(T)},atoms:i};for(let f of c)f.getActions&&Object.assign(l,f.getActions?.(s,d));return{pluginsActions:l,pluginsAtoms:i,pluginPathMethods:u,atomListeners:h,$fetch:s,$store:d}};function rt(e,t,r){let n=t[e],{fetchOptions:s,query:a,...o}=r||{};return n||(s?.method?s.method:o&&Object.keys(o).length>0?"POST":"GET")}function nt(e,t,r,n,s){function a(o=[]){return new Proxy(function(){},{get(c,l){let i=[...o,l],u=e;for(let h of i)if(u&&typeof u=="object"&&h in u)u=u[h];else{u=void 0;break}return typeof u=="function"?u:a(i)},apply:async(c,l,i)=>{let u="/"+o.map(E=>E.replace(/[A-Z]/g,P=>`-${P.toLowerCase()}`)).join("/"),h=i[0]||{},d=i[1]||{},{query:f,fetchOptions:T,...q}=h,O={...d,...T},A=rt(u,r,h);return await t(u,{...O,body:A==="GET"?void 0:{...q,...O?.body||{}},query:f||O?.query,method:A,async onSuccess(E){await O?.onSuccess?.(E);let P=s?.find(p=>p.matcher(u));if(!P)return;let y=n[P.signal];if(!y)return;let $=y.get();setTimeout(()=>{y.set(!$)},10)}})}})}return a()}var Q=(e,t)=>r=>{e.current=r,t()};function st(e,{keys:t,deps:r=[e,t]}={}){let n=C.useRef();n.current=e.get();let s=C.useCallback(o=>(t?.length||0)>0?ie(e,t,Q(n,o)):e.listen(Q(n,o)),r),a=()=>n.current;return C.useSyncExternalStore(s,a,a)}function ot(e){return`use${it(e)}`}function it(e){return e.charAt(0).toUpperCase()+e.slice(1)}function at(e){let{pluginPathMethods:t,pluginsActions:r,pluginsAtoms:n,$fetch:s,$store:a,atomListeners:o}=tt(e),c={};for(let[i,u]of Object.entries(n))c[ot(i)]=()=>st(u);let l={...r,...c,$fetch:s,$store:a};return nt(l,s,t,n,o)}const ct=at({baseURL:"http://localhost:3000",plugins:[ke()]});export{ct as a};
